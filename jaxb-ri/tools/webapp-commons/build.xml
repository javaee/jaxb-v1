<?xml version="1.0"?>

<!--
 Copyright 2004 Sun Microsystems, Inc. All rights reserved.
 SUN PROPRIETARY/CONFIDENTIAL. Use is subject to license terms.
-->

<project name="JAXB WebApp commons" default="dist" basedir="../..">

  <!-- import build properties -->
  <property file="${basedir}/build.properties" />
  
  
  <property name="commons.root" value="${jaxb.root}/tools/webapp-commons" />
  
  <!-- libraries that are referenced when compiling Java source files -->
  <path id="javac.classpath">
    <pathelement path="${codemodel.classes}" />
    <pathelement path="${runtime.classes}" />
    <pathelement path="${xjc.classes}" />
    <fileset dir="${jaxb.libs.redist}" includes="*.jar"/>
    <fileset dir="${jaxb.libs.rebundle}" includes="*.jar"/>
    <fileset dir="${jaxb.libs.util}" includes="*.jar"/>
  </path>
  
  
  
  
  
  <target name="dist" depends="clean,jar, src-zip" description="Clean build and dist" />
  
  
  
  <target name="clean">
    <delete dir="${commons.root}/build"/>
    <delete>
    	<fileset dir="${commons.root}" includes="jaxb-webapp-commons*.jar" />
    	<fileset dir="${commons.root}" includes="jaxb-webapp-commons*.src.zip" />
    </delete>
  </target>
  
  
  <target name="compile">
    <!-- Compile Java classes as necessary -->
    <mkdir    dir="${commons.root}/build/classes"/>
    <javac srcdir="${commons.root}/src" destdir="${commons.root}/build/classes"
           debug="${compile.debug}" optimize="${compile.optimize}"
           deprecation="${compile.deprecation}" >
      <classpath refid="javac.classpath"/>
    </javac>
    
    <!-- Copy associated resource files -->
    <copy  todir="${commons.root}/build/classes">
      <fileset dir="${commons.root}/src" includes="**/*.properties"/>
    </copy>
  </target>
  
  
  
  <target name="jar" description="build a jar file" depends="compile">
    <jar destfile="${commons.root}/jaxb-webapp-commons.jar">
      <fileset dir="${commons.root}/build/classes"/>
      <metainf dir="${commons.root}" includes="taglib.tld" />
    </jar>
    <jar destfile="${commons.root}/jaxb-webapp-commons-compact.jar">
      <fileset dir="${commons.root}/build/classes" excludes="**/multipart/**" />
      <metainf dir="${commons.root}" includes="taglib.tld" />
    </jar>
  </target>
  
  
  
  <target name="src-zip" description="build a source zip file" depends="compile">
    <zip destfile="${commons.root}/jaxb-webapp-commons.src.zip">
      <fileset dir="${commons.root}/src"/>
    </zip>
    <zip destfile="${commons.root}/jaxb-webapp-commons-compact.src.zip">
      <fileset dir="${commons.root}/src" excludes="**/multipart/**"/>
    </zip>
  </target>
</project>
